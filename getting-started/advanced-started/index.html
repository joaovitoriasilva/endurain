<!DOCTYPE html>
<html lang="en" data-bs-theme="auto">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Getting started advanced - Endurain documentation</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" disabled>
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Endurain documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Hosting Guide</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../getting-started/" class="dropdown-item">Getting started easy</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Getting started advanced</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Integrations</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../integrations/3rd-party-apps/" class="dropdown-item">3rd party apps</a>
</li>
                                    
<li>
    <a href="../../integrations/3rd-party-services/" class="dropdown-item">3rd party services</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="../../developer-guide/" class="nav-link">Developer guide</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../gallery/" class="nav-link">Gallery</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../getting-started/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../integrations/3rd-party-apps/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/joaovitoriasilva/endurain/edit/master/docs/getting-started/advanced-started.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                            <li class="nav-item dropdown">
                              <button id="theme-menu" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme" class="nav-link dropdown-toggle">
                                <i class="fa-solid fa-circle-half-stroke fa-fw"></i>
                                <span class="d-lg-none ms-2">Toggle theme</span>
                              </button>
                              <ul class="dropdown-menu dropdown-menu-end">
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                                    <i class="fa-solid fa-sun fa-fw"></i>
                                    <span class="ms-2">Light</span>
                                    <i class="fa-solid fa-check ms-auto d-none"></i>
                                  </button>
                                </li>
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                                    <i class="fa-solid fa-moon fa-fw"></i>
                                    <span class="ms-2">Dark</span>
                                    <i class="fa-solid fa-check ms-auto d-none"></i>
                                  </button>
                                </li>
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="auto" aria-pressed="true">
                                    <i class="fa-solid fa-circle-half-stroke fa-fw"></i>
                                    <span class="ms-2">Auto</span>
                                    <i class="fa-solid fa-check ms-auto"></i>
                                  </button>
                                </li>
                              </ul>
                            </li>
                    </ul>
                </div>
            </div>
        </div>
        <script src="../../js/darkmode.js"></script>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="2"><a href="#default-credentials" class="nav-link">Default Credentials</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#docker-deployment" class="nav-link">Docker Deployment</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#supported-environment-variables" class="nav-link">Supported Environment Variables</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#volumes" class="nav-link">Volumes</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#bulk-import-and-file-upload" class="nav-link">Bulk import and file upload</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="2"><a href="#image-personalization" class="nav-link">Image personalization</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h2 id="default-credentials">Default Credentials</h2>
<ul>
<li><strong>Username:</strong> admin  </li>
<li><strong>Password:</strong> admin</li>
</ul>
<h2 id="docker-deployment">Docker Deployment</h2>
<p>Endurain provides a Docker image for simplified deployment. To get started, check out the <code>docker-compose.yml.example</code> file in the project repository and adjust it according to your setup. Supported tags are:</p>
<ul>
<li><strong>latest:</strong> contains the latest released version;</li>
<li><strong>version, example "v0.3.0":</strong> contains the app state available at the time of the version specified;</li>
<li><strong>development version, example "dev_06092024":</strong> contains a development version of the app at the date specified. This is not a stable released and may contain issues and bugs. Please do not open issues if using a version like this unless asked by me.</li>
</ul>
<h2 id="supported-environment-variables">Supported Environment Variables</h2>
<p>Table below shows supported environment variables. Variables marked with optional "No" should be set to avoid errors.</p>
<table>
<thead>
<tr>
<th>Environment variable</th>
<th>Default value</th>
<th>Optional</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>UID</td>
<td>1000</td>
<td>Yes</td>
<td>User ID for mounted volumes. Default is 1000</td>
</tr>
<tr>
<td>GID</td>
<td>1000</td>
<td>Yes</td>
<td>Group ID for mounted volumes. Default is 1000</td>
</tr>
<tr>
<td>TZ</td>
<td>UTC</td>
<td>Yes</td>
<td>Timezone definition. Useful for TZ calculation for activities that do not have coordinates associated, like indoor swim or weight training. If not specified UTC will be used. List of available time zones <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">here</a>. Format <code>Europe/Lisbon</code> expected</td>
</tr>
<tr>
<td>ENDURAIN_HOST</td>
<td>No default set</td>
<td><code>No</code></td>
<td>Required for internal communication and Strava. For Strava https must be used. Host or local ip (example: http://192.168.1.10:8080 or https://endurain.com)</td>
</tr>
<tr>
<td>REVERSE_GEO_PROVIDER</td>
<td>geocode</td>
<td>Yes</td>
<td>Defines reverse geo provider. Expects <a href="https://geocode.maps.co/">geocode</a> or photon. photon can be the <a href="https://photon.komoot.io">SaaS by komoot</a> or a self hosted version like a <a href="https://github.com/rtuszik/photon-docker">self hosted version</a></td>
</tr>
<tr>
<td>PHOTON_API_HOST</td>
<td>photon.komoot.io</td>
<td>Yes</td>
<td>API host for photon. By default it uses the <a href="https://photon.komoot.io">SaaS by komoot</a></td>
</tr>
<tr>
<td>PHOTON_API_USE_HTTPS</td>
<td>true</td>
<td>Yes</td>
<td>Protocol used by photon. By default uses HTTPS to be inline with what <a href="https://photon.komoot.io">SaaS by komoot</a> expects</td>
</tr>
<tr>
<td>GEOCODES_MAPS_API</td>
<td>changeme</td>
<td>Yes</td>
<td><a href="https://geocode.maps.co/">Geocode maps</a> offers a free plan consisting of 1 Request/Second. Registration necessary.</td>
</tr>
<tr>
<td>GEOCODES_MAPS_RATE_LIMIT</td>
<td>1</td>
<td>yes</td>
<td>Change this if you have a paid Geocode maps tier</td>
</tr>
<tr>
<td>DB_TYPE</td>
<td>postgres</td>
<td>Yes</td>
<td>mariadb or postgres</td>
</tr>
<tr>
<td>DB_HOST</td>
<td>postgres</td>
<td>Yes</td>
<td>mariadb or postgres</td>
</tr>
<tr>
<td>DB_PORT</td>
<td>5432</td>
<td>Yes</td>
<td>3306 or 5432</td>
</tr>
<tr>
<td>DB_USER</td>
<td>endurain</td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td>DB_PASSWORD</td>
<td>No default set</td>
<td><code>No</code></td>
<td>N/A</td>
</tr>
<tr>
<td>DB_DATABASE</td>
<td>endurain</td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td>SECRET_KEY</td>
<td>No default set</td>
<td><code>No</code></td>
<td>Run <code>openssl rand -hex 32</code> on a terminal to get a secret</td>
</tr>
<tr>
<td>FERNET_KEY</td>
<td>No default set</td>
<td><code>No</code></td>
<td>Run <code>python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"</code> on a terminal to get a secret or go to <a href="https://fernetkeygen.com">https://fernetkeygen.com</a>. Example output is <code>7NfMMRSCWcoNDSjqBX8WoYH9nTFk1VdQOdZY13po53Y=</code></td>
</tr>
<tr>
<td>ALGORITHM</td>
<td>HS256</td>
<td>Yes</td>
<td>Currently only HS256 is supported</td>
</tr>
<tr>
<td>ACCESS_TOKEN_EXPIRE_MINUTES</td>
<td>15</td>
<td>Yes</td>
<td>Time in minutes</td>
</tr>
<tr>
<td>REFRESH_TOKEN_EXPIRE_DAYS</td>
<td>7</td>
<td>Yes</td>
<td>Time in days</td>
</tr>
<tr>
<td>JAEGER_ENABLED</td>
<td>false</td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td>JAEGER_PROTOCOL</td>
<td>http</td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td>JAEGER_HOST</td>
<td>jaeger</td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td>JAEGER_PORT</td>
<td>4317</td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr>
<td>BEHIND_PROXY</td>
<td>false</td>
<td>Yes</td>
<td>Change to true if behind reverse proxy</td>
</tr>
<tr>
<td>ENVIRONMENT</td>
<td>production</td>
<td>Yes</td>
<td>"production" and "development" allowed. "development" allows connections from localhost:8080 and localhost:5173 at the CORS level</td>
</tr>
</tbody>
</table>
<p>Table below shows the obligatory environment variables for mariadb container. You should set them based on what was also set for the Endurain container.</p>
<table>
<thead>
<tr>
<th>Environemnt variable</th>
<th>Default value</th>
<th>Optional</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>MYSQL_ROOT_PASSWORD</td>
<td>changeme</td>
<td><code>No</code></td>
<td>N/A</td>
</tr>
<tr>
<td>MYSQL_DATABASE</td>
<td>endurain</td>
<td><code>No</code></td>
<td>N/A</td>
</tr>
<tr>
<td>MYSQL_USER</td>
<td>endurain</td>
<td><code>No</code></td>
<td>N/A</td>
</tr>
<tr>
<td>MYSQL_PASSWORD</td>
<td>changeme</td>
<td><code>No</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<p>Table below shows the obligatory environment variables for postgres container. You should set them based on what was also set for the Endurain container.</p>
<table>
<thead>
<tr>
<th>Environemnt variable</th>
<th>Default value</th>
<th>Optional</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>POSTGRES_PASSWORD</td>
<td>changeme</td>
<td><code>No</code></td>
<td>N/A</td>
</tr>
<tr>
<td>POSTGRES_DB</td>
<td>endurain</td>
<td><code>No</code></td>
<td>N/A</td>
</tr>
<tr>
<td>POSTGRES_USER</td>
<td>endurain</td>
<td><code>No</code></td>
<td>N/A</td>
</tr>
<tr>
<td>PGDATA</td>
<td>/var/lib/postgresql/data/pgdata</td>
<td><code>No</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<p>To check Python backend dependencies used, use poetry file (pyproject.toml).</p>
<p>Frontend dependencies:</p>
<ul>
<li>To check npm dependencies used, use npm file (package.json)</li>
<li>Logo created on Canva</li>
</ul>
<h2 id="volumes">Volumes</h2>
<p>Docker image uses a non-root user, so ensure target folders are not owned by root. Non-root user should use UID and GID 1000. It is recommended to configure the following volumes for data persistence:</p>
<table>
<thead>
<tr>
<th>Volume</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;local_path&gt;/endurain/backend/logs:/app/backend/logs</code></td>
<td>Log files for the backend</td>
</tr>
<tr>
<td><code>&lt;local_path&gt;/endurain/backend/data:/app/backend/data</code></td>
<td>Necessary for image and activity files persistence on docker image update</td>
</tr>
</tbody>
</table>
<h2 id="bulk-import-and-file-upload">Bulk import and file upload</h2>
<p>To perform a bulk import:
- Place .fit, .tcx, .gz and/or .gpx files into the activity_files/bulk_import folder. Create the folder if needed.
- In the "Settings" menu select "Integrations".
- Click "Import" next to "Bulk Import".</p>
<p>.fit files are preferred. I noticed that Strava/Garmin Connect process of converting .fit to .gpx introduces additional data to the activity file leading to minor variances in the data, like for example additional 
meters in distance and elevation gain. Some notes:</p>
<ul>
<li>After the files are processed, the files are moved to the processed folder</li>
<li>GEOCODES API has a limit of 1 Request/Second on the free plan, so if you have a large number of files, it might not be possible to import all in the same action</li>
<li>The bulk import currently only imports data present in the .fit, .tcx or .gpx files - no metadata or other media are imported.</li>
</ul>
<h2 id="image-personalization">Image personalization</h2>
<p>It is possible (v0.10.0 or higher) to personalize the login image in the login page. To do that, map the data/server_images directory for image persistence on container updates and:
 - Set the image in the server settings zone of the settings page
 - A square image is expected. Default one uses 1000px vs 1000px</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
